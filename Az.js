const Discord = require('discord.js');
const fs = require('fs');
const client = new Discord.Client
client.on('ready', () => {
     console.log(`Sx0lyy. BOT STARTED`);
     console.log(`ON ${client.guilds.size} Servers `);
   console.log(`Logged in as ${client.user.tag}!`);
   client.user.setGame(`Simple Server.`,"http://twitch.tv/fuckoff")
  });
var prefix = "#"
client.on('message', message => {
     if(message.content.startsWith(prefix + "Ù…Ø³Ø­")) {
         var args = message.content.split(" ").slice(1);
 if (!message.member.hasPermission('MANAGE_MESSAGES')) return message.reply('**Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø¨Ø±Ù…Ø´Ù† Manage_Messages.**');
  if (!args[0]) return message.channel.send('**Ø¶Ø¹ Ø¹Ø¯Ø¯ Ù„Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Øª ,**');

  message.channel.bulkDelete(args[0]).then(() => {
    const embed = new Discord.RichEmbed()
      .setColor("#FFFFFF")
      .setDescription("```"+ args[0] +" : Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙŠ ØªÙ… Ù…Ø³Ø­Ù‡Ø§```");
    message.channel.send({ embed });

    const actionlog = message.guild.channels.find('name', 'log');
 if (!actionlog) return message.channel.send('**Ù„Ù… Ø§Ø¬Ø¯ Ø±ÙˆÙ… Ø§Ù„Ù„ÙˆÙ‚ ÙˆÙ…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø§Ù† Ù„ÙŠØ³ Ù„Ø¯ÙŠ Ø¨Ø±Ù…Ø´Ù† Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø´Ø§Øª ÙˆØ´ÙƒØ±Ø§Ù‹**');
    const embedlog = new Discord.RichEmbed()
      .setDescription('Ù…Ø³Ø­ Ø§Ù„Ø´Ø§Øª')
      .setColor('#FFFFFF')
      .addField('Ù…Ø³Ø­ Ù…Ù† Ù‚Ø¨Ù„', `<@${message.author.id}>`)
      .addField('ÙÙŠ Ø´Ø§Øª', message.channel)
      .addField('ÙˆÙ‚Øª Ø§Ù„Ù…Ø³Ø­', message.createdAt);
    actionlog.send(embedlog);
   
  });
};

});
let rebel;
   client.on("ready", async  => {
       let guild = client.guilds.get("510036694486220800");
     let users = guild.members.map(member => member.user.id);
     let i;
     rebel=0;
   for (i=0 ; i < users.length ; i++) {
    let   check = guild.members.get(users[i]);
   if(!check.voiceChannelID){
           continue;
   }else{
     rebel++;
   }
   }
   guild.channels.find('id', '517008281781272593').setName(" Voice Online ["+rebel+"]");
     client.setInterval(() =>{
       let d = Date.now()
     }, 5000);
   });
   client.on('voiceStateUpdate', (oldMember, newMember) => {
       let guild = client.guilds.get("510036694486220800");
   let newUserChannel = newMember.voiceChannel
   let oldUserChannel = oldMember.voiceChannel
    if(oldUserChannel === undefined && newUserChannel !== undefined) {
      rebel++;
   guild.channels.find('id', '517008281781272593').setName(" Voice Online ["+rebel+"]");
   } else if(newUserChannel === undefined){
     rebel--;
   guild.channels.find('id', '517008281781272593').setName(" Voice Online ["+rebel+"]");
   }
   });
   client.on('message', Codes => { 
     if(Codes.content === "#voice") {
         Codes.channel.send(" Voice Online ["+rebel+"]");
   }
   });
const tpoints = JSON.parse(fs.readFileSync('./Text.json', 'UTF8'));
const vpoints = JSON.parse(fs.readFileSync('./Voice.json', 'UTF8'));
client.on('ready',async () => {
  console.log(`.Codes TOP.`);
  client.users.forEach(m => {
    if(m.bot) return;
    if(!tpoints[m.id]) tpoints[m.id] = {points: 0, id: m.id};
    fs.writeFileSync("./Text.json", JSON.stringify(tpoints, null, 2));
 
    if(!vpoints[m.id]) vpoints[m.id] = {points: 0, id: m.id};
    fs.writeFileSync("./Voice.json", JSON.stringify(vpoints, null, 2));
  });
});
 
client.on('message',async message => {
  if(message.author.bot || message.channel.type === 'dm') return;
  let args = message.content.split(' ');
  let member = message.member;
  let mention = message.mentions.users.first();
  let guild = message.guild;
  let author = message.author;
 
  let rPoints = Math.floor(Math.random() * 2) + 1;// Random Points
  tpoints[author.id].points += rPoints;
  fs.writeFileSync("./Text.json", JSON.stringify(tpoints, null, 2));
  if(args[0] === `#ØªÙˆØ¨`) {
    let _voicePointer = 1;
    let _textPointer = 1;
    let _voiceArray = Object.values(vpoints);
    let _textArray = Object.values(tpoints);
    let _topText = _textArray.slice(0, 5).map(r => `**\`#${_textPointer++}\` | <@${r.id}> \`XP: ${r.points}\`**`).sort((a, b) => a > b).join('\n');
    let _voiceText = _voiceArray.slice(0, 5).map(r => `**\`#${_voicePointer++}\` | <@${r.id}> \`XP: ${r.points}\`**`).sort((a, b) => a > b).join('\n');
 
    const topRoyale = new Discord.RichEmbed();
    topRoyale.setColor('#fffff0')
    topRoyale.setAuthor(message.author.username, message.author.avatarURL);
    topRoyale.setTitle('Top Voice & Text.');
    topRoyale.setThumbnail(message.guild.iconURL);
    topRoyale.addField(`**TOP 5 TEXT ðŸ’¬**`, _topText, true);
    topRoyale.addField(`**TOP 5 VOICE ðŸŽ™**`, _voiceText, true);
    message.channel.send(topRoyale).catch(e => {
      if(e) return message.channel.send(`**. Error; \`${e.message}\`**`);
    });
  }
});
 
client.on('voiceStateUpdate', (u, member) => {
  let author = member.user.id;
  let guild = member.guild;
  if(member.voiceChannel === null) return;
  let rPoints = Math.floor(Math.random() * 2) + 1;// Random Points
  setInterval(() => {
    if(!member.voiceChannel) return;
    if(member.selfDeafen) return;
    vpoints[author].points += rPoints;
    fs.writeFileSync("./Voice.json", JSON.stringify(vpoints, null, 2));
  }, 5000); // 5 Secs
});
var prefix = '#'
  client.on('message', message => {
    if(!message.channel.guild) return;
    if(message.content.startsWith(prefix + 'Ø§Ø³Ø­Ø¨')) {
     if (message.member.hasPermission("MOVE_MEMBERS")) {
     if (message.mentions.users.size === 0) {
     return message.channel.send("``Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ù…Ø± Ø§ÙƒØªØ¨ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ù…Ø± : " +prefix+ "Ø§Ø³Ø­Ø¨ [USER]``")
    }
    if (message.member.voiceChannel != null) {
     if (message.mentions.members.first().voiceChannel != null) {
         if(message.channel.name != null) {
     var arc = message.member.voiceChannelID;
     var usermentioned = message.mentions.members.first().id;
     var Ce = message.member.voiceChannel.name; 
    var embed = new Discord.RichEmbed()
     .setTitle("Succes!")
     .setColor("#ffffff")
     .setDescription(`:white_check_mark: Ù„Ù‚Ø¯ Ù‚Ø§Ù… Ø´Ø®Øµ Ù…Ø§ Ø¨Ø³Ø­Ø¨Ùƒ Ø§Ù„Ù‰ Ø±ÙˆÙ…Ù‡ Ø§Ù„Ø´Ø®ØµÙŠ`)
    var embed = new Discord.RichEmbed() 
    .setTitle(`Done !!.`)
    .setColor("#ffffff") 
    .setDescription(`âœ… <@${usermentioned}> **moved to** `+ Ce +` `)   
    message.guild.members.get(usermentioned).setVoiceChannel(arc).then(m => message.channel.send(embed))
    message.guild.members.get(usermentioned).send(embed)
    } else {
    message.channel.send("``Ù„Ø§ ØªØ³ØªØ·ÙŠØ¹ Ø³Ø­Ø¨ "+ message.mentions.members.first() +" `ÙŠØ¬Ø¨ Ø§Ù† ÙŠÙƒÙˆÙ† Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ø¶Ùˆ ÙÙŠ Ø±ÙˆÙ… ØµÙˆØªÙŠ`")
    }
    } else {
     message.channel.send("``ÙŠØ¬Ø¨ Ø§Ù† ØªÙƒÙˆÙ† ÙÙŠ Ø±ÙˆÙ… ØµÙˆØªÙŠ Ù„ÙƒÙŠ ØªÙ‚ÙˆÙ… Ø¨Ø³Ø­Ø¨ Ø§Ù„Ø¹Ø¶Ùˆ Ø£Ù„ÙŠÙƒ``")
    }
    } else {
    message.react("âŒ")
     }}}});

 client.on('message', message => {
    let args = message.content.split(' ').slice(1);
    if(message.content.startsWith(prefix + 'Ø±ÙˆÙ„')) {
        let member = message.mentions.users.first();
        let role = args.join(' ').replace(member, '').replace(args[0], '').replace(' ', '');
        console.log(role);
        if(member) {
              if(role.startsWith('-')) {
                let roleRe = args.join(' ').replace(member, '').replace(args[0], '').replace('-', '').replace(' ', '');
                console.log(roleRe);
                let role1 = message.guild.roles.find('name', roleRe);
                console.log(`hi`);
const ee =new Discord.RichEmbed()
 .setDescription('**:x: I canâ€™t find the role.**')
 .setFooter('Requested By '+message.author.username,message.author.avatarURL)
        if(!role1) return message.channel.send(ee);                message.guild.member(member).removeRole(role1.id);
                
                     const e = new Discord.RichEmbed()
                     
                 .setDescription(':white_check_mark:** Changed Roles For **'+member+'**,** '+'**'+'-'+role1.name+'**')
                .setFooter('Requested By '+message.author.username,message.author.avatarURL)
                .setColor('#ffffff')
                 message.channel.send(e)
            } else if(!role.startsWith('-')) {
                let roleRe = args.join(' ').replace(member, '').replace(args[0], '').replace('-', '').replace(' ', '');
                let role1 = message.guild.roles.find('name', roleRe);
const ee =new Discord.RichEmbed()
 .setDescription('**:x: I canâ€™t find the role.**')
 .setFooter('Requested By : '+message.author.username,message.author.avatarURL)
        if(!role1) return message.channel.send(ee);                message.guild.member(member).addRole(role1);
                const e = new Discord.RichEmbed()
                
                .setDescription(':white_check_mark:** Changed Roles For **'+member+'**,** '+'**'+'+'+role1.name+'**')
                .setFooter('Requested By : '+message.author.username,message.author.avatarURL)
                .setColor('#ffffff')
                 message.channel.send(e)
            } else {
                message.reply(`ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù… Ø§Ù„Ø±ØªØ¨Ø©`);
            } 
        }
 else if(args[0] == 'all') {
  if(role.startsWith('-')) { 
       let roleRe = args.join(' ').replace(member, '').replace(args[0], '').replace('-', '').replace(' ', '');
         let role1 = message.guild.roles.find('name', roleRe);
                   message.channel.send(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø§Ù…Ø±`).then(msg =>{
           message.guild.members.forEach(m => {
            message.guild.member(m).removeRole(role1.id);
        });
         msg.edit(`** :white_check_mark: Done...\n**` +role1.name+`** Has Taken From __${message.guild.members.size}__ Member**`);
    });
  }
    if(role) {
    let role1 = message.guild.roles.find('name', role);
    if(!role1) return;
    message.channel.send(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø§Ù…Ø±`).then(msg => {
        message.guild.members.forEach(m => {
            message.guild.member(m).addRole(role1);
        });
        msg.edit(`** :white_check_mark: Done...\n**` +  role1.name+`** Has Given To __${message.guild.members.size}__ Members **`);
    });
}
} else if(args[0] == 'humans') {
     if(role.startsWith('-')) { 
       let roleRe = args.join(' ').replace(member, '').replace(args[0], '').replace('-', '').replace(' ', '');
         let role1 = message.guild.roles.find('name', roleRe);
                   message.channel.send(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø§Ù…Ø±`).then(msg =>{
           message.guild.members.forEach(m => {
            message.guild.member(m).removeRole(role1.id);
        });
         msg.edit(`** :white_check_mark: Done...\n**` +role1.name+`** Has Taken From __${message.guild.members.size}__ Member**`);
    });
  }

    if(role) {
        let role1 = message.guild.roles.find('name', role);

 const ee =new Discord.RichEmbed()
 .setDescription('I Cannâ€™t Find This Role')
 .setFooter('Requested By : '+message.author.username,message.author.avatarURL)
        if(!role1) return message.channel.send(ee);
        message.channel.send(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø§Ù…Ø±`).then(msg => {
            message.guild.members.filter(m =>m.user.bot == false).forEach(m => {
                message.guild.member(m).addRole(role1);
            });
        msg.edit(`** :white_check_mark: Done...**`);
        });
    }
} else if(args[0] == 'bots') {
     if(role.startsWith('-')) { 
       let roleRe = args.join(' ').replace(member, '').replace(args[0], '').replace('-', '').replace(' ', '');
         let role1 = message.guild.roles.find('name', roleRe);
                   message.channel.send(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø§Ù…Ø±`).then(msg =>{
           message.guild.members.forEach(m => {
            message.guild.member(m).removeRole(role1.id);
        });
         msg.edit(`** :white_check_mark: Done...**`);
    });
  }
    if(role) {
        let role1 = message.guild.roles.find('name', role);
       const ee =new Discord.RichEmbed()
 .setDescription('I Cannâ€™t Find This Role')
 .setFooter('Requested By : '+message.author.username,message.author.avatarURL)
        if(!role1) return message.channel.send(ee);
        message.channel.send(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØªÙ… Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù† Ø§Ù„Ø§Ù…Ø±`).then(msg => {
            message.guild.members.filter(m =>m.user.bot == true).forEach(m => {
                message.guild.member(m).addRole(role1);
            });
        msg.edit(`** :white_check_mark: Done...\n**` +role1.name+`** Has Given To __${message.guild.members.size}__ Member**`);
});
}
}
}
});
client.on('message', message => {
    if (message.author.id === client.user.id) return;
    if (message.guild) {
    let embed = new Discord.RichEmbed()
    let args = message.content.split(' ').slice(1).join(' ');
   if(message.content.split(' ')[0] == prefix + 'bc') {
    if (!args[1]) {
   message.channel.send("**#bc1 <message>**");
   return;
   }
      message.guild.members.forEach(m => {
    if(!message.member.hasPermission('ADMINISTRATOR')) return;
        var bc = new Discord.RichEmbed()
        .setAuthor(message.author.username, message.author.avatarURL)
        .addField('** Ø§Ù„Ù€Ø³ÙŠØ±ÙØ±**', `${message.guild.name}`,true)
        .addField(' **Ø§Ù„Ù€Ù…Ø±Ø³Ù„ **', `${message.author.username}#${message.author.discriminator}`,true)
        .addField(' **Ø§Ù„Ø±Ø³Ø§Ù„Ø©** ', args)
        .setThumbnail(message.guild.iconURL)
        .setColor('#ffffff')
        m.send(`${m}`,{embed: bc});
      });
      const AziRo = new Discord.RichEmbed()
      .setAuthor(message.author.username, message.author.avatarURL)  
      .setTitle('âœ”ï¸ | Ø¬Ø§Ø±ÙŠ Ø§Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ ') 
      .addBlankField(true)
      .addField('ðŸ‘¥ | Ø¹Ø¯Ø¯ Ø§Ù„Ø§Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ù…Ø±Ø³Ù„ Ù„Ù‡Ù… ', message.guild.memberCount , true)    
      .addField('ðŸ“‹| Ø§Ù„Ø±Ø³Ø§Ù„Ø© ', args)
      .setColor('#ffffff') 
      message.channel.sendEmbed(AziRo);     
    }
    } else {
      return;
    }
   });
  client.on('message', message => {
    if(!message.channel.guild) return;
  if(message.content.startsWith('#bc2')) {
  if(!message.channel.guild) return message.channel.send('**Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ÙÙ‚Ø· Ù„Ù„Ø³ÙŠØ±ÙØ±Ø§Øª**').then(m => m.delete(5000));
  if(!message.member.hasPermission('ADMINISTRATOR')) return      message.channel.send('**Ù„Ù„Ø£Ø³Ù Ù„Ø§ ØªÙ…ØªÙ„Ùƒ ØµÙ„Ø§Ø­ÙŠØ©** `ADMINISTRATOR`' );
  let args = message.content.split(" ").join(" ").slice(2 + prefix.length);
  let copy = "Simple Server!";
  let request = `Requested By ${message.author.username}`;
  if (!args) return message.reply('**ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø© Ø§Ùˆ Ø¬Ù…Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙˆØ¯ÙƒØ§Ø³Øª**');message.channel.send(`**Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø±Ø³Ø§Ù„Ùƒ Ø§Ù„Ø¨Ø±ÙˆØ¯ÙƒØ§Ø³ØªØŸ \nÙ…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¨Ø±ÙˆØ¯ÙƒØ§Ø³Øª:** \` ${args}\``).then(msg => {
  msg.react('âœ…')
  .then(() => msg.react('âŒ'))
  .then(() =>msg.react('âœ…'))
  let reaction1Filter = (reaction, user) => reaction.emoji.name === 'âœ…' && user.id === message.author.id;
  let reaction2Filter = (reaction, user) => reaction.emoji.name === 'âŒ' && user.id === message.author.id;
  let reaction1 = msg.createReactionCollector(reaction1Filter, { time: 12000 });
  let reaction2 = msg.createReactionCollector(reaction2Filter, { time: 12000 });
  reaction1.on("collect", r => {
  message.channel.send(`â˜‘ | Done ... The Broadcast Message Has Been Sent For ${message.guild.members.size} Members`).then(m => m.delete(5000));
  message.guild.members.forEach(m => {
  var bc = new Discord.RichEmbed()
  .setColor('ffffff')
  .setTitle('Broadcast')
      .addField("â— [Ù…Ù† Ø³ÙŠØ±ÙØ±]", message.guild.name)
      .addField("â— [Ø¥Ù„Ù‰]", `${m}`)
      .addField("â— [Ø§Ù„Ø±Ø³Ø§Ù„Ø©]", args)
  .setThumbnail(message.author.avatarURL)
  .setFooter(copy, client.user.avatarURL);
  m.send({ embed: bc })
  msg.delete();
  })
  })
  reaction2.on("collect", r => {
  message.channel.send(`**Broadcast Canceled.**`).then(m => m.delete(5000));
  msg.delete();
  })
  })
  }
  });
  client.on('message', message => {
    var prefix = "#"
    if (message.author.x5bz) return;
    if (!message.content.startsWith(prefix)) return;
    let command = message.content.split(" ")[0];
    command = command.slice(prefix.length);
    let args = message.content.split(" ").slice(1);
    if (command == "ban") {
                 if(!message.channel.guild) return message.reply('** This command only for servers**'); 
    if(!message.guild.member(message.author).hasPermission("BAN_MEMBERS")) return message.reply("**You Don't Have ` BAN_MEMBERS ` Permission**");
    if(!message.guild.member(client.user).hasPermission("BAN_MEMBERS")) return message.reply("**I Don't Have ` BAN_MEMBERS ` Permission**");
    let user = message.mentions.users.first();
    let reason = message.content.split(" ").slice(2).join(" ");
    if (message.mentions.users.size < 1) return message.channel.send({
    files: [
      "./met.png"
    ]
  })
    if (!message.guild.member(user)
    .bannable) return message.reply("**I D'ont Have Permission For Ban This User**");
    message.guild.member(user).ban(7, user);
    message.channel.send(`:white_check_mark:  ${user.tag} banned from the server ! :airplane:  `)
  }
  });
client.login(process.env.BOT_TOKEN)
